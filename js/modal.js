document.addEventListener('DOMContentLoaded', function () {
    const worksModal = document.getElementById('works-modal');
    const bookModal = document.getElementById('book-modal');
    const worksList = document.getElementById('works-list');
    const worksTitle = document.getElementById('works-title');
    const bookContent = document.getElementById('book-content');

    const worksClose = document.querySelector('.works-close');
    const bookClose = document.querySelector('.book-close');
    const worksOverlay = document.getElementById('works-modal');
    const bookOverlay = document.getElementById('book-modal');

    const worksData = {
        socrates: [
            {
                id: 'apology',
                title: 'Апология Сократа',
                desc: 'Это не сухая судебная речь, а философский манифест. Платон воссоздаёт выступление Сократа на суде, где тот вместо оправдания бросает вызов афинскому обществу: «Неучастие в поиске истины — смерть для души». Сократ утверждает, что его «божественный голос» — даймоний — велит ему разбудить Афины, как будто он овод, жалящий город-коня. Он отказывается молчать, даже зная, что это приговорит его к смерти. Эта книга — гимн свободе мысли и мужеству быть верным себе.',
                img: 'img/book_apology.jpg'
            }
        ],
        plato: [
            {
                id: 'republic',
                title: 'Государство',
                desc: 'В этом диалоге Платон строит идеальное общество, где власть принадлежит не богатым или сильным, а мудрым — философам. Он делит душу на три части — разум, волю и желания — и утверждает, что справедливость в государстве зеркальна справедливости в человеке. Через аллегорию пещеры он показывает, как большинство людей путают тени на стене с реальностью, а философ — тот, кто выходит на свет и видит Солнце истины. «Государство» — это не утопия, а вызов: как устроить мир, где правит разум, а не страсть?',
                img: 'img/book_republic.jpg'
            },
            {
                id: 'symposium',
                title: 'Пир',
                desc: 'Шесть мужчин на пиру посвящают речи богу любви — Эросу. От забавных до глубоких, их слова раскрывают любовь как путь к бессмертию: через детей, славу или, наивысший уровень — через стремление к Красоте и Истине. Особенно знаменита речь Сократа, передающая учение Диотимы: истинная любовь — это лестница от земной привязанности к созерцанию вечной, божественной Красоты. «Пир» — это философия, пронизанная поэзией, где любовь становится двигателем всего сущего.',
                img: 'img/book_symposium.jpg'
            }
        ],
        aristotle: [
            {
                id: 'ethics',
                title: 'Никомахова этика',
                desc: 'Аристотель задаётся простым, но грозным вопросом: «В чём смысл жизни?» Его ответ — эвдемония: не мимолётное удовольствие, а долговременное процветание через добродетельную деятельность. Добродетель — это не абстракция, а золотая середина между крайностями: храбрость — между трусостью и безрассудством, щедрость — между скупостью и расточительностью. Он учит, что характер формируется привычками: «Мы становимся справедливыми, совершая справедливые поступки». Эта книга — практическое руководство к достойной жизни.',
                img: 'img/book_ethics.jpg'
            },
            {
                id: 'politics',
                title: 'Политика',
                desc: 'Человек, по Аристотелю, по природе «зoon политikon» — общественное существо. В «Политике» он анализирует сотни государств, чтобы найти наилучшее устройство. Он критикует крайности: тиранию, олигархию, анархию — и ищет устойчивую смешанную форму, где интересы всех слоёв учтены. Особенно поражает его идея: цель политики — не власть, а развитие добродетели граждан. Эта работа заложила основы политической науки и до сих пор удивляет своей актуальностью.',
                img: 'img/book_politics.jpg'
            }
        ],
        descartes: [
            {
                id: 'meditations',
                title: 'Размышления о первой философии',
                desc: 'Декарт начинает с радикального сомнения: «А вдруг весь мир — иллюзия, созданная злым гением?» Единственное, в чём он не может усомниться, — это факт собственного мышления. Отсюда знаменитое «Cogito, ergo sum» — «Я мыслю, следовательно, существую». Далее он логически доказывает существование Бога и реальность внешнего мира. Эта книга — рождение современного субъекта, разума, который сам строит основания знания. Она изменила ход философии и науки навсегда.',
                img: 'img/book_meditations.jpg'
            },
            {
                id: 'discourse',
                title: 'Рассуждение о методе',
                desc: 'Здесь Декарт предлагает универсальный метод познания, основанный на четырёх правилах: принимать за истину только ясное и отчётливое, делить сложное на части, идти от простого к сложному, ничего не упуская. Он применяет его ко всему — от математики до этики. В этом труде впервые появляется аналитическая геометрия и идея, что природа подчиняется математическим законам. Это манифест рационализма: разум — наш главный инструмент против хаоса и заблуждений.',
                img: 'img/book_discourse.jpg'
            }
        ],
        kant: [
            {
                id: 'critique',
                title: 'Критика чистого разума',
                desc: 'Кант ставит революционный вопрос: «Как возможно знание?» Он показывает, что мы не пассивно воспринимаем мир, а активно конструируем его с помощью форм разума — времени, пространства и категорий. Вещи в себе (ноумены) нам недоступны; мы видим лишь явления, отформатированные нашим сознанием. Эта «коперниканская революция» в философии ограничила притязания разума, но открыла путь к этике, основанной не на знании, а на свободе. Книга трудна, но без неё — ни Гегеля, ни Эйнштейна.',
                img: 'img/book_critique.jpg'
            },
            {
                id: 'groundwork',
                title: 'Основоположение метафизики нравов',
                desc: 'Если «Критика» ограничила разум, то здесь Кант открывает свободу. Он ищет высший нравственный закон, независимый от желаний. Его ответ — категорический императив: «Поступай так, чтобы максима твоей воли могла стать всеобщим законом». Это не совет, а повеление разума. Человек ценен не как средство, а как цель сама по себе. Эта книга — фундамент современной этики, прав человека и уважения к личности.',
                img: 'img/book_groundwork.jpg'
            }
        ],
        nietzsche: [
            {
                id: 'nihilism',
                title: 'Так говорил Заратустра',
                desc: 'Ницше создаёт пророка Заратустру, который нисходит с горы, чтобы возвестить новую истину: «Бог мёртв — и мы убили его». Вместо старых ценностей он предлагает идею сверхчеловека — того, кто создаёт собственную мораль, преодолевая стадное мышление. Через парадоксы, поэзию и притчи Заратустра учит: «Человек — это что-то, что должно быть преодолено». Книга — вызов, загадка и призыв к величию, написанная в стиле, близком к священному писанию будущего.',
                img: 'img/book_zarathustra.jpg'
            },
            {
                id: 'genealogy',
                title: 'К генеалогии морали',
                desc: 'Ницше роет под фундамент христианской морали. Он утверждает, что понятия «добро» и «зло» возникли не из любви, а из мести слабых к сильным. «Рабская мораль» прославляет смирение, сострадание, послушание — качества, полезные угнетённым. А «аристократическая мораль» чтила силу, гордость, мужество. Эта книга — разоблачение: наши самые священные ценности могут быть маской для воли к власти. Чтение требует мужества — но вознаграждает свободой мысли.',
                img: 'img/book_genealogy.jpg'
            }
        ]
    };

    document.querySelectorAll('.works-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            const key = btn.closest('.philosopher-card').dataset.philosopher;
            const works = worksData[key] || [];
            const philosopherNames = {
                socrates: 'Сократа',
                plato: 'Платона',
                aristotle: 'Аристотеля',
                descartes: 'Декарта',
                kant: 'Канта',
                nietzsche: 'Ницше'
            };
            worksTitle.textContent = `Ключевые труды ${philosopherNames[key]}`;
            worksList.innerHTML = '';
            works.forEach(work => {
                const btn = document.createElement('button');
                btn.textContent = work.title;
                btn.addEventListener('click', () => {
                    bookContent.innerHTML = `
                        <img src="${work.img}" alt="${work.title}">
                        <h3>${work.title}</h3>
                        <div class="description">${work.desc}</div>
                    `;
                    worksModal.style.display = 'none';
                    bookModal.style.display = 'flex';
                });
                worksList.appendChild(btn);
            });
            worksModal.style.display = 'flex';
        });
    });

    const closeActions = [
        { el: worksClose, modal: worksModal },
        { el: bookClose, modal: bookModal },
        { el: worksOverlay, modal: worksModal },
        { el: bookOverlay, modal: bookModal }
    ];

    closeActions.forEach(item => {
        item.el.addEventListener('click', () => {
            item.modal.style.display = 'none';
        });
    });

    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            worksModal.style.display = 'none';
            bookModal.style.display = 'none';
        }
    });
});